# Claude Studio Environment Configuration
# P09-T009: Production environment variables

# Server Configuration
NODE_ENV=production
PORT=3333
HOST=127.0.0.1

# Logging
LOG_LEVEL=info  # Options: debug, info, warn, error

# Docker Configuration
DOCKER_HOST=unix:///var/run/docker.sock

# Session Configuration
SESSION_TIMEOUT_MS=1800000  # 30 minutes
CLEANUP_INTERVAL_MS=300000  # 5 minutes

# Container Defaults
CONTAINER_MEMORY_LIMIT=536870912  # 512MB in bytes
CONTAINER_CPU_LIMIT=1.0
CONTAINER_TIMEOUT_MS=300000  # 5 minutes

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000  # 1 minute
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_CONTAINER_MAX=10
RATE_LIMIT_PREVIEW_MAX=20

# CORS Configuration
CORS_ORIGIN=http://localhost:3850

# Security
ENABLE_SECURITY_HEADERS=true
TRUST_PROXY=true

# Preview Configuration
PREVIEW_MAX_REDIRECTS=5
PREVIEW_TIMEOUT_MS=30000

# Circuit Breaker
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT_MS=60000
CIRCUIT_BREAKER_RESET_MS=300000

# Health Check
HEALTH_CHECK_INTERVAL_MS=60000

# Workspace Paths (allowed directories)
ALLOWED_WORKSPACE_PATHS=/opt/dev,/opt/prod

# Chrome DevTools MCP Integration
# Enable Chrome DevTools Protocol (CDP) integration for Claude MCP support
# Default: false (disabled)
# Accepted values: true, 1, 'true', 'yes' (case-insensitive)
MCP_ENABLED=false

# Chrome Debug Port
# Port where Chrome/Chromium is running with DevTools Protocol enabled
# Used for both Chrome availability detection and Claude MCP integration
# Default: 9223 (standard Chrome remote debugging port)
# Valid range: 1-65535
CHROME_DEBUG_PORT=9223

# WebSocket Authentication Token (CRITICAL SECURITY)
# ================================================
# SECURITY FIX (CRITICAL-001): Token required for WebSocket connections
#
# REQUIRED in production, optional in development (defaults to 'dev-token-12345')
#
# Generate secure production token:
#   openssl rand -hex 32
#
# CRITICAL SECURITY REQUIREMENTS:
# - NEVER commit production tokens to version control
# - Use different tokens for development and production
# - Rotate tokens regularly (recommended: every 90 days)
# - Store production tokens in secure environment variable management
#   (e.g., Coolify secrets, AWS Secrets Manager, HashiCorp Vault)
#
# Connection format: ws://host:port?token=YOUR_TOKEN_HERE
#
# WARNING: Without proper token configuration:
# - Unauthorized users can create Docker containers on your server
# - Attackers can execute arbitrary code in containers
# - System resources can be exhausted via DoS attacks
#
# For development only, use:
WS_AUTH_TOKEN=dev-token-12345
#
# For production, generate and set a secure token:
# WS_AUTH_TOKEN=<paste-output-of-openssl-rand-hex-32-here>
